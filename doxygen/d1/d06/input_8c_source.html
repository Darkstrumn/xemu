<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xemu ~ source level documentation: targets/ep128/input.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../xemu-48x48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xemu ~ source level documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_0b1b62fddf6df8c66e0bcbb711b1f333.html">targets</a></li><li class="navelem"><a class="el" href="../../dir_702ac98556f28b3631f04acd30eb0262.html">ep128</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">input.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d06/input_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Xep128: Minimalistic Enterprise-128 emulator with focus on &quot;exotic&quot; hardware</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   Copyright (C)2015,2016 LGB (Gábor Lénárt) &lt;lgblgblgb@gmail.com&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   http://xep128.lgb.hu/</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">(at your option) any later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">GNU General Public License for more details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/df4/xep128_8h.html">xep128.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/ded/input_8h.html">input.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d13/dave_8h.html">dave.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d94/keyboard__mapping_8h.html">keyboard_mapping.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/ddc/screen_8h.html">screen.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d5a/joystick_8h.html">joystick.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;SDL.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> move_dx, move_dy, nibble_counter;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#ad0ac6df3892f25f13403f077ff4ecaaa">   30</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a> = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> wheel_dx, wheel_dy;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a> nibble;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> mouse_button1, mouse_button2;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> rts_old_level = -1;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> mouse_pulse = 0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//static int _mouse_wait_warn = 1;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../d0/d3b/fat32_8c.html#add440eff171ea5f55cb00c4a9ab8672d">Uint32</a> <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a>; <span class="comment">// we use Nick&#39;s raster_time &quot;timing source&quot; because it&#39;s kinda free without introducing another timer source</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d0/d3b/fat32_8c.html#add440eff171ea5f55cb00c4a9ab8672d">Uint32</a> watchdog_mouse;           <span class="comment">// watchdog value (raster_time related) used by the mouse nibble-reset protocol</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d0/d3b/fat32_8c.html#add440eff171ea5f55cb00c4a9ab8672d">Uint32</a> watchdog_xep128;          <span class="comment">// watchdog value (raster_time related) used by Xep128 to decide between joy-1 and j-column mouse</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a63e32b51cb46f8186f153f2f2aba7ed2">   41</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d06/input_8c.html#a63e32b51cb46f8186f153f2f2aba7ed2">show_keys</a> = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> control_port_emu_mode = -1;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/* The mouse buffer. nibble_counter shows which nibble is to read (thus &quot;nibble_counter &gt;&gt; 1&quot; is the byte pointer actually.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">   mouse_protocol_nibbles limits the max nibbles to read, ie it&#39;s 4 (= 2 bytes) for boxsoft protocol for the default setting */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a> mouse_buffer[] = {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        0x00,   <span class="comment">// BOXSOFT: delta X as signed, positive-left, updated from mouse_dx</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        0x00,   <span class="comment">// BOXSOFT: delta Y as signed, positive-up, updates from mouse_dy</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        0x10,   <span class="comment">// EXTENDED MSX: proto ID + extra buttons on lower nibble (I update those - lower nibble - on mouse SDL events)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        0x00,   <span class="comment">// EXTENDED MSX: horizontal wheel (it&#39;s splitted for horizontal/Z, but according to entermice it&#39;s handled as a 8 bit singed now for a single wheel, so I do this as well)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        0x44,   <span class="comment">// ENTERMICE: extra bytes to read (incl this: 4 now) + PS/2 Mouse ID [it&#39;s 4 now ...]</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        0x14,   <span class="comment">// ENTERMICE: hardware version major.minor</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        0x19,   <span class="comment">// ENTERMICE: firmware version major.minor</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        0x5D    <span class="comment">// ENTERMICE: Device ID, should be 5D for Entermice</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;};</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">   57</a></span>&#160;<span class="preprocessor">#define WATCHDOG_USEC(n) (n / 64)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/* Values can be used in mouse modes, buttons[] array to map PC mouse buttons to EP related mouse buttons </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">   The first two are mapped then according to the button*_mask of the mode struct.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">   The EX buttons instructs setting the button status in mouse buffer directly at byte 3, lower nibble</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">   63</a></span>&#160;<span class="preprocessor">#define BUTTON_MAIN     1</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">   64</a></span>&#160;<span class="preprocessor">#define BUTTON_OTHER    2</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">   65</a></span>&#160;<span class="preprocessor">#define BUTTON_EX3      3</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">   66</a></span>&#160;<span class="preprocessor">#define BUTTON_EX4      4</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">   67</a></span>&#160;<span class="preprocessor">#define BUTTON_EX5      5</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/* Values can be used in *_mask options in mouse modes struct */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a597dc300d5919a96a20db9aafe9f233b">   70</a></span>&#160;<span class="preprocessor">#define J_COLUMN        1</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a3fc69113544bb8325c3e9ea9c4c85321">   71</a></span>&#160;<span class="preprocessor">#define K_COLUMN        2</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html">   73</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/d45/structmouse__modes__st.html">mouse_modes_st</a> {</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html#a8f8f80d37794cde9472343e4487ba3eb">   74</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d45/structmouse__modes__st.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;       <span class="comment">// some name for the given mouse protocol/mode ...</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html#a0af704609df3a7bd1a6f3518eb743c75">   75</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d9/d45/structmouse__modes__st.html#a0af704609df3a7bd1a6f3518eb743c75">buttons</a>[5];         <span class="comment">// button map: indexed by emulator given PC left/middle/right/x1/x2 (in this order), with values of the BUTTON_* macros above to map to protcol values</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html#a656d3a843ee9d0eb89e3e34c01b55aa6">   76</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d9/d45/structmouse__modes__st.html#a656d3a843ee9d0eb89e3e34c01b55aa6">nibbles</a>;            <span class="comment">// nibbles in the protocol (before the constant zero answer or warping around if warp is non-zero)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html#a49468a16361d11e78ebbfc41f2a5aa6c">   77</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d9/d45/structmouse__modes__st.html#a49468a16361d11e78ebbfc41f2a5aa6c">wrap</a>;               <span class="comment">// wraps around nibble counter automatically or not (not = constant zero nibble answer, watchdog can only reset the counter)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html#a03a2c1c7a4c376bfcd7e6ba15bcfafb6">   78</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d9/d45/structmouse__modes__st.html#a03a2c1c7a4c376bfcd7e6ba15bcfafb6">watchdog</a>;           <span class="comment">// watchdog time-out, or -1, for not using watchdog, times are Xep128 specific use the WATCHDOG_USEC macro to convert from usec!</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d9/d45/structmouse__modes__st.html#a5ad72a5b78977b3b3db3212287e09806">   79</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d9/d45/structmouse__modes__st.html#a5ad72a5b78977b3b3db3212287e09806">data_mask</a>;          <span class="comment">// bit mask for mouse data read (J/K/L = 1 / 2 / 4), you can use *_COLUMN macros</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;};</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/* Definition of mouse modes follows :) */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/d45/structmouse__modes__st.html">mouse_modes_st</a> mouse_modes[] = {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {       <span class="comment">// MODE - 0: NOT USED POSITION</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }, {    <span class="comment">// MODE - 1:</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                .<a class="code" href="../../d9/d45/structmouse__modes__st.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> =         <span class="stringliteral">&quot;BoxSoft J-col&quot;</span>,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                .buttons =      { <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>, <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>, <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>, <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>, <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a> },      <span class="comment">// mapping for SDL left/middle/right/X1/X2 events to EP</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                .nibbles =      4,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                .wrap =         0,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                .watchdog =     <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(1500),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                .data_mask =    <a class="code" href="../../d1/d06/input_8c.html#a597dc300d5919a96a20db9aafe9f233b">J_COLUMN</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        }, {    <span class="comment">// MODE - 2:</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                .name =         <span class="stringliteral">&quot;ExtMSX J-col&quot;</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                .buttons =      { <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>, <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>, <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>, <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>, <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a> },      <span class="comment">// mapping for SDL left/middle/right/X1/X2 events to EP</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                .nibbles =      8,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                .wrap =         0,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                .watchdog =     <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(1500),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                .data_mask =    <a class="code" href="../../d1/d06/input_8c.html#a597dc300d5919a96a20db9aafe9f233b">J_COLUMN</a></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }, {    <span class="comment">// MODE - 3:</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                .name =         <span class="stringliteral">&quot;EnterMice J-col&quot;</span>,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                .buttons =      { <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>, <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>, <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>, <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>, <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a> },      <span class="comment">// mapping for SDL left/middle/right/X1/X2 events to EP</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                .nibbles =      16,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                .wrap =         0,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                .watchdog =     <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(1500),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                .data_mask =    <a class="code" href="../../d1/d06/input_8c.html#a597dc300d5919a96a20db9aafe9f233b">J_COLUMN</a></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }, {    <span class="comment">// MODE - 4:</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                .name =         <span class="stringliteral">&quot;BoxSoft K-col&quot;</span>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                .buttons =      { <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>, <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>, <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>, <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>, <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a> },      <span class="comment">// mapping for SDL left/middle/right/X1/X2 events to EP</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                .nibbles =      4,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                .wrap =         0,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                .watchdog =     <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(1500),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                .data_mask =    <a class="code" href="../../d1/d06/input_8c.html#a3fc69113544bb8325c3e9ea9c4c85321">K_COLUMN</a></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }, {    <span class="comment">// MODE - 5:</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                .name =         <span class="stringliteral">&quot;ExtMSX K-col&quot;</span>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                .buttons =      { <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>, <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>, <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>, <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>, <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a> },      <span class="comment">// mapping for SDL left/middle/right/X1/X2 events to EP</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                .nibbles =      8,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                .wrap =         0,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                .watchdog =     <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(1500),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                .data_mask =    <a class="code" href="../../d1/d06/input_8c.html#a3fc69113544bb8325c3e9ea9c4c85321">K_COLUMN</a></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }, {    <span class="comment">// MODE - 6:</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                .name =         <span class="stringliteral">&quot;EnterMice K-col&quot;</span>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                .buttons =      { <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>, <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>, <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>, <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>, <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a> },      <span class="comment">// mapping for SDL left/middle/right/X1/X2 events to EP</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                .nibbles =      16,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                .wrap =         0,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                .watchdog =     <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(1500),</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                .data_mask =    <a class="code" href="../../d1/d06/input_8c.html#a3fc69113544bb8325c3e9ea9c4c85321">K_COLUMN</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;};</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a460806d5f5360a26d0b18b6cf3dca814">  130</a></span>&#160;<span class="preprocessor">#define LAST_MOUSE_MODE ((sizeof(mouse_modes) / sizeof(const struct mouse_modes_st)) - 1)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/d45/structmouse__modes__st.html">mouse_modes_st</a> *<a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>;       <span class="comment">// current mode mode, pointer to the selected mouse_modes</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a2d60dfa7c3586ec04dc98e8e18daafcc">  133</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d06/input_8c.html#a2d60dfa7c3586ec04dc98e8e18daafcc">mouse_mode</a>;                                 <span class="comment">// current mode, with an integer</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">  135</a></span>&#160;<span class="preprocessor">#define JOYSTICK_SCAN(num, dir) joystick_scan(num, dir)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#ad11af82c9993545badf6af4cbf8e9faa">  139</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d06/input_8c.html#ad11af82c9993545badf6af4cbf8e9faa">mouse_mode_description</a> ( <span class="keywordtype">int</span> cfg, <span class="keywordtype">char</span> *buffer )</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (cfg == 0)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                cfg = <a class="code" href="../../d1/d06/input_8c.html#a2d60dfa7c3586ec04dc98e8e18daafcc">mouse_mode</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">if</span> (cfg &lt; 1 || cfg &gt; <a class="code" href="../../d1/d06/input_8c.html#a460806d5f5360a26d0b18b6cf3dca814">LAST_MOUSE_MODE</a>) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                sprintf(buffer, <span class="stringliteral">&quot;#%d *** Invalid mouse mode ***&quot;</span>, cfg);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                sprintf(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        buffer,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        <span class="stringliteral">&quot;#%d (%s) nibbles=%d wrap=%d watchdog=%d mask=%d&quot;</span>,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        cfg,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        mouse_modes[cfg].<a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        mouse_modes[cfg].<a class="code" href="../../d9/d45/structmouse__modes__st.html#a656d3a843ee9d0eb89e3e34c01b55aa6">nibbles</a>,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                        mouse_modes[cfg].<a class="code" href="../../d9/d45/structmouse__modes__st.html#a49468a16361d11e78ebbfc41f2a5aa6c">wrap</a>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        mouse_modes[cfg].<a class="code" href="../../d9/d45/structmouse__modes__st.html#a03a2c1c7a4c376bfcd7e6ba15bcfafb6">watchdog</a>,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                        mouse_modes[cfg].<a class="code" href="../../d9/d45/structmouse__modes__st.html#a5ad72a5b78977b3b3db3212287e09806">data_mask</a></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                );</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#a8797e32ed46cecb131581bb44e4d3990">  163</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d06/input_8c.html#a8797e32ed46cecb131581bb44e4d3990">mouse_reset_button</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        mouse_button1 = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        mouse_button2 = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        mouse_buffer[2] &amp;= 0xF0;        <span class="comment">// extra buttons for MSX extended protocol should be cleared as well</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> set_button ( <a class="code" href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a> *storage, <span class="keywordtype">int</span> <a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a>, <span class="keywordtype">int</span> pressed )</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (pressed)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                *storage |= <a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                *storage &amp;= 255 - <a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#a9aa29cbc03517be05303ef2d01f9479a">  182</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d06/input_8c.html#a9aa29cbc03517be05303ef2d01f9479a">emu_mouse_button</a> ( <a class="code" href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a> sdl_button, <span class="keywordtype">int</span> press )</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d2/d84/joystick_8c.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">switch</span> (sdl_button) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">case</span> SDL_BUTTON_LEFT:</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;left&quot;</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        <span class="keywordtype">id</span> = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">case</span> SDL_BUTTON_MIDDLE:</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;middle&quot;</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        <span class="keywordtype">id</span> = 1;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">case</span> SDL_BUTTON_RIGHT:</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;right&quot;</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keywordtype">id</span> = 2;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">case</span> SDL_BUTTON_X1:</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;x1&quot;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        <span class="keywordtype">id</span> = 3;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <span class="keywordflow">case</span> SDL_BUTTON_X2:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                        <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;x2&quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        <span class="keywordtype">id</span> = 4;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;UNKNOWN&quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        <span class="keywordtype">id</span> = -1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: BUTTON: event: SDL#%d XEP#%d (%s) %s&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>, sdl_button, <span class="keywordtype">id</span>, <a class="code" href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, press ? <span class="stringliteral">&quot;pressed&quot;</span> : <span class="stringliteral">&quot;released&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: BUTTON: unknown button on SDL level (see previous MOUSE: line)!!&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">// unknown mouse button??</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (sdl_button == SDL_BUTTON_LEFT &amp;&amp; press &amp;&amp; <a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a> == 0) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="comment">//emu_osd_msg(&quot;Mouse grab. Press ESC to exit.&quot;);</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <a class="code" href="../../d5/d88/screen_8c.html#abfec8bad7720b38a264ea0d485a1f152">screen_grab</a>(SDL_TRUE);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a> = 1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="../../d1/d06/input_8c.html#a8797e32ed46cecb131581bb44e4d3990">mouse_reset_button</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a>) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: BUTTON: not in grab mode, do not forward event&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">// not in mouse grab mode</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;buttons[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a>:</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        mouse_button1 = press;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a>:</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        mouse_button2 = press;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a>:</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                        set_button(&amp;mouse_buffer[2], 1, press);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a>:</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        set_button(&amp;mouse_buffer[2], 2, press);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a>:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        set_button(&amp;mouse_buffer[2], 4, press);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                        <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: used mouse button cannot be mapped for the given mouse mode (map=%d), ignored&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>, <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;buttons[<span class="keywordtype">id</span>]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#a9c6e59f8433c130974927919a9db4148">  251</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d06/input_8c.html#a9c6e59f8433c130974927919a9db4148">emu_mouse_motion</a> ( <span class="keywordtype">int</span> dx, <span class="keywordtype">int</span> dy )</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: MOTION: event: dx = %d, dy = %d&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>, dx, dy);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a>) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: MOTION: not in grab mode, do not forward event&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">// not in mouse grab mode</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        move_dx -= dx;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span> (move_dx &gt; 127) move_dx = 127;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (move_dx &lt; -128) move_dx = -128;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        move_dy -= dy;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span> (move_dy &gt; 127) move_dy = 127;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (move_dy &lt; -128) move_dy = -128;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#abe9cce308f45bb08d664c5ef85140f83">  268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d06/input_8c.html#abe9cce308f45bb08d664c5ef85140f83">emu_mouse_wheel</a> ( <span class="keywordtype">int</span> <a class="code" href="../../d8/d51/recpm_2console_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <span class="keywordtype">int</span> <a class="code" href="../../d8/d51/recpm_2console_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>, <span class="keywordtype">int</span> flipped )</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: WHEEL: event: x = %d, y = %d, flipped = %d&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>, <a class="code" href="../../d8/d51/recpm_2console_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <a class="code" href="../../d8/d51/recpm_2console_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>, flipped);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a>) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: WHEEL: not in grab mode, do not forward event&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">// not in mouse grab mode</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        flipped = flipped ? -1 : 1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        wheel_dx -= <a class="code" href="../../d8/d51/recpm_2console_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> * flipped;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> (wheel_dx &gt; 127) wheel_dx = 127;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wheel_dx &lt; -128) wheel_dx = -128;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        wheel_dy -= <a class="code" href="../../d8/d51/recpm_2console_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> * flipped;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> (wheel_dy &gt; 127) wheel_dy = 127;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wheel_dy &lt; -128) wheel_dy = -128;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#a17f09b1b0019a960c7d9f6f79ca65345">  286</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d06/input_8c.html#a17f09b1b0019a960c7d9f6f79ca65345">mouse_reset</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;{</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// mouse_grab = 0; // commented out to fix the issue: emu reset hotkey is pressed with grabbed mouse ...</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        nibble_counter = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">//if (rts_old_level == -1)</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        rts_old_level = 0;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        nibble = 0;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        move_dx = 0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        move_dy = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        wheel_dx = 0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        wheel_dy = 0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        watchdog_mouse = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        watchdog_xep128 = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="../../d1/d06/input_8c.html#a8797e32ed46cecb131581bb44e4d3990">mouse_reset_button</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        mouse_buffer[0] = mouse_buffer[1] = mouse_buffer[3] = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> check_mouse_watchdog ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordtype">int</span> time = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a> - watchdog_mouse;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        watchdog_mouse = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;watchdog &gt;= 0 &amp;&amp; (time &gt; <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;watchdog || time &lt; 0)) <span class="comment">// negative case in case of raster_time counter warp-around (integer overflow)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                nibble_counter = 0;     <span class="comment">// in case of timeout, nibble counter resets to zero</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">// Called from cpu.c in case of read port 0xB6, this function MUST only give back bits 0-2, ie control ports ones, higher bits</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">// bits should be zero as they are used for other purposes (ie: tape, printer ...) and OR&#39;ed by cpu.c at port reading func ...</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#a38a4d3ac176d8ff2c5d1c49245d5350e">  317</a></span>&#160;<a class="code" href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a> <a class="code" href="../../d1/d06/input_8c.html#a38a4d3ac176d8ff2c5d1c49245d5350e">read_control_port_bits</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordtype">int</span> mouse_ok, joy1_ok;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">int</span> time = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a> - watchdog_xep128;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// Note: unlike watchdog_mouse, watchdog_xep128 is set in check data shift only but queried here</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> (time &lt; 0)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                watchdog_xep128 = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a>;  <span class="comment">// integer overflow</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask == <a class="code" href="../../d1/d06/input_8c.html#a3fc69113544bb8325c3e9ea9c4c85321">K_COLUMN</a>) {              <span class="comment">// mouse on K-column, joy-1 is always enabled</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                mouse_ok = 2;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                joy1_ok = 1;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mouse_pulse &amp;&amp; (time &lt; <a class="code" href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a>(100000) || time &lt; 0)) { <span class="comment">// mouse on J-column, joy-1 is disabled on mouse usage</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                mouse_ok = 2;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                joy1_ok = 0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        } <span class="keywordflow">else</span> {                                        <span class="comment">// mouse on J-column, joy-1 is enabled because no mouse usage</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                mouse_ok = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                joy1_ok = 1;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                mouse_pulse = 0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> (control_port_emu_mode != mouse_ok + joy1_ok) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *m[] = { <span class="stringliteral">&quot;joystick&quot;</span>, <span class="stringliteral">&quot;Mouse&quot;</span>, <span class="stringliteral">&quot;dual (K-col)&quot;</span> };</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                control_port_emu_mode = mouse_ok + joy1_ok;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <a class="code" href="../../d1/df4/xep128_8h.html#a7b07ef73975a2766765a64425ae4ee43">OSD</a>(<span class="stringliteral">&quot;Control port: %s mode&quot;</span>, m[control_port_emu_mode - 1 ]);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../da/d71/dave_8c.html#a69b2034307eede446ae2d54706852c35">kbd_selector</a>) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="comment">/* joystick-1 or mouse related */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <span class="keywordflow">case</span>  0: <span class="comment">// The Entermice wiki mentioned priority of mouse buttons are not so much implemented ... TODO</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                (mouse_ok ? ((mouse_button1 ? 0 : <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask) | (7 - <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask - 4) | (mouse_button2 ? 0 : 4)) : 7) &amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                (joy1_ok ? ((<a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#a1639273f22bb275b92990d3bcef8885c">JOY_SCAN_FIRE1</a>) ? 0 : 1) | (<a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#afefc4719a71e8e74a776d1d3770a20c1">JOY_SCAN_FIRE2</a>) ? 0 : 2) | (<a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#a364833821774f6697a2f38dadd1af873">JOY_SCAN_FIRE3</a>) ? 0 : 4)) : 7);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="keywordflow">case</span>  1: <span class="keywordflow">return</span> (mouse_ok ? (((nibble &amp; 1) ? <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask : 0) | (7 - <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask)) : 7) &amp; ((joy1_ok &amp;&amp; <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#a0f02d0142cc5bbb169c601846df6bf5c">JOY_SCAN_UP</a>   )) ? 6 : 7);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">case</span>  2: <span class="keywordflow">return</span> (mouse_ok ? (((nibble &amp; 2) ? <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask : 0) | (7 - <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask)) : 7) &amp; ((joy1_ok &amp;&amp; <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#a6acc06e48fc9c9fa27316147afcc6aaf">JOY_SCAN_DOWN</a> )) ? 6 : 7);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordflow">case</span>  3: <span class="keywordflow">return</span> (mouse_ok ? (((nibble &amp; 4) ? <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask : 0) | (7 - <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask)) : 7) &amp; ((joy1_ok &amp;&amp; <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#ab209282edfaeb97a7aebff2b8a2d95e3">JOY_SCAN_LEFT</a> )) ? 6 : 7);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">case</span>  4: <span class="keywordflow">return</span> (mouse_ok ? (((nibble &amp; 8) ? <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask : 0) | (7 - <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;data_mask)) : 7) &amp; ((joy1_ok &amp;&amp; <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(0, <a class="code" href="../../de/ded/input_8h.html#a6b61a96d64da933d85da475a2e3fb08f">JOY_SCAN_RIGHT</a>)) ? 6 : 7);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="comment">/* always joystick#2 on J-column (bit 0), other bits are spare */</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordflow">case</span>  5: <span class="keywordflow">return</span> (<a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#a1639273f22bb275b92990d3bcef8885c">JOY_SCAN_FIRE1</a>) ? 0 : 1) | (<a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#afefc4719a71e8e74a776d1d3770a20c1">JOY_SCAN_FIRE2</a>) ? 0 : 2) | (<a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#a364833821774f6697a2f38dadd1af873">JOY_SCAN_FIRE3</a>) ? 0 : 4);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">case</span>  6: <span class="keywordflow">return</span>  <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#a0f02d0142cc5bbb169c601846df6bf5c">JOY_SCAN_UP</a>   ) ? 6 : 7;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">case</span>  7: <span class="keywordflow">return</span>  <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#a6acc06e48fc9c9fa27316147afcc6aaf">JOY_SCAN_DOWN</a> ) ? 6 : 7;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">case</span>  8: <span class="keywordflow">return</span>  <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#ab209282edfaeb97a7aebff2b8a2d95e3">JOY_SCAN_LEFT</a> ) ? 6 : 7;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">case</span>  9: <span class="keywordflow">return</span>  <a class="code" href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a>(1, <a class="code" href="../../de/ded/input_8h.html#a6b61a96d64da933d85da475a2e3fb08f">JOY_SCAN_RIGHT</a>) ? 6 : 7;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="comment">/* and if not ... */</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 7;      <span class="comment">// it shouldn&#39;t happen too much (only if no valid scan row is selected?)</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">// Called from cpu.c in case of write of port 0xB7</span></div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#af82fa4e8a84126c46a67531977c694f7">  364</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d06/input_8c.html#af82fa4e8a84126c46a67531977c694f7">mouse_check_data_shift</a> ( <a class="code" href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a> val )</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">if</span> ((val &amp; 2) == rts_old_level)         <span class="comment">// check of change on the RTS signal change</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">// if no change, we&#39;re not interested in at all, mouse &quot;nibble shifting&quot; in RTS _edge_ triggered (both of the edges!) not level</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        rts_old_level = val &amp; 2;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        mouse_pulse = 1;                        <span class="comment">// this variable is only for the emulator to keep track of mouse reading tries and display OSD, etc</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        watchdog_xep128 = <a class="code" href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a>;          <span class="comment">// this watchdog is used to control auto-switch of Xep128 between J-column mouse and joy-1 emulation</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        check_mouse_watchdog();                 <span class="comment">// this is the mouse watchdog to reset nibble counter in a given timeout</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (nibble_counter &gt;= <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;nibbles &amp;&amp; <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>-&gt;wrap)      <span class="comment">// support nibble counter wrap-around mode, if the current mouse mode directs that</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                nibble_counter = 0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">// note:  information larger than one nibble shouldn&#39;t updated by the mouse SDL events directly in mouse_buffer, because it&#39;s possible</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="comment">// that between the reading of two nibbles that is modified. To avoid this, these things are updated here at a well defined counter state only:</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">if</span> (nibble_counter == 0) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <span class="comment">// update mouse buffer byte 0 with delta X</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="comment">//mouse_buffer[0] = ((unsigned int)move_dx) &amp; 0xFF;    // signed will be converted to unsigned</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                mouse_buffer[0] = move_dx;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                move_dx = 0;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nibble_counter == 2) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="comment">// update mouse buffer byte 1 with delta Y</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="comment">//mouse_buffer[1] = ((unsigned int)move_dy) &amp; 0xFF;    // signed will be converted to unsigned</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                mouse_buffer[1] = move_dy;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                move_dy = 0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nibble_counter == 6) {       <span class="comment">// this may not be used at all, if mouse_protocol_nibbles limits the available nibbles to read, boxsoft will not read this ever!</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                mouse_buffer[3] = wheel_dy;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                wheel_dy = 0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (nibble_counter &lt; mode-&gt;<a class="code" href="../../d9/d45/structmouse__modes__st.html#a656d3a843ee9d0eb89e3e34c01b55aa6">nibbles</a>) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="comment">// if nibble counter is below the constraint of the used mouse protocol, provide the upper or lower nibble of the buffer</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="comment">// based on the counter&#39;s lowest bit (ie, odd or even)</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                nibble = ((nibble_counter &amp; 1) ? (mouse_buffer[nibble_counter &gt;&gt; 1] &amp; 15) : (mouse_buffer[nibble_counter &gt;&gt; 1] &gt;&gt; 4));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                nibble_counter++;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                nibble = 0;     <span class="comment">// if we hit the max number of nibbles, we constantly provide zero as the nibble, until watchdog resets</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#abe573ffdd89c43a81a9ea5b8b38dad3c">  401</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d06/input_8c.html#abe573ffdd89c43a81a9ea5b8b38dad3c">mouse_setup</a> ( <span class="keywordtype">int</span> cfg )</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordtype">char</span> buffer[128];</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span> (cfg &lt; 0)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d1/d06/input_8c.html#a2d60dfa7c3586ec04dc98e8e18daafcc">mouse_mode</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">if</span> (cfg &lt; 1 || cfg &gt; <a class="code" href="../../d1/d06/input_8c.html#a460806d5f5360a26d0b18b6cf3dca814">LAST_MOUSE_MODE</a>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                cfg = 1;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="../../d1/d06/input_8c.html#a2d60dfa7c3586ec04dc98e8e18daafcc">mouse_mode</a> = cfg;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a> = &amp;mouse_modes[cfg];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="../../d1/d06/input_8c.html#ad11af82c9993545badf6af4cbf8e9faa">mouse_mode_description</a>(cfg, buffer);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <a class="code" href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;MOUSE: SETUP: %s&quot;</span> <a class="code" href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>, buffer);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="../../d1/d06/input_8c.html#a17f09b1b0019a960c7d9f6f79ca65345">mouse_reset</a>();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">return</span> cfg;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">/* ------------------- KEYBOARD ----------------------- */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="../../de/ded/input_8h.html#a829a12f841537fed33232bbbf7246d5e">  420</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d06/input_8c.html#a829a12f841537fed33232bbbf7246d5e">emu_kbd</a>(SDL_Keysym sym, <span class="keywordtype">int</span> press)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d06/input_8c.html#a63e32b51cb46f8186f153f2f2aba7ed2">show_keys</a> &amp;&amp; press)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <a class="code" href="../../d1/df4/xep128_8h.html#a7b07ef73975a2766765a64425ae4ee43">OSD</a>(<span class="stringliteral">&quot;SDL scancode is \&quot;%s\&quot; (%d)&quot;</span>, SDL_GetScancodeName(sym.scancode), sym.scancode);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a> &amp;&amp; sym.scancode == SDL_SCANCODE_ESCAPE &amp;&amp; press) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <a class="code" href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a> = 0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <a class="code" href="../../d5/d88/screen_8c.html#abfec8bad7720b38a264ea0d485a1f152">screen_grab</a>(SDL_FALSE);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../da/ddf/structkey_mapping_table__st.html">keyMappingTable_st</a> *ke = <a class="code" href="../../d9/d6e/keyboard__mapping_8c.html#a15b42a96c012e30262c24c91dce2e2c9">keymap_resolve_event</a>(sym);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">if</span> (ke) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        <span class="keywordtype">int</span> sel  = ke-&gt;<a class="code" href="../../da/ddf/structkey_mapping_table__st.html#a3489a10912c536ae8ee4b122b32b6915">posep</a> &gt;&gt; 4;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        <span class="keywordtype">int</span> <a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a> = 1 &lt;&lt; (ke-&gt;<a class="code" href="../../da/ddf/structkey_mapping_table__st.html#a3489a10912c536ae8ee4b122b32b6915">posep</a> &amp; 15);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a> &lt; 0x100) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                <span class="keywordflow">if</span> (press)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                        <a class="code" href="../../da/d71/dave_8c.html#aba4a26be2633bba89bf26c9a92819563">kbd_matrix</a>[sel] &amp;= 255 - <a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                        <a class="code" href="../../da/d71/dave_8c.html#aba4a26be2633bba89bf26c9a92819563">kbd_matrix</a>[sel] |= <a class="code" href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                <span class="keywordflow">return</span> ke-&gt;<a class="code" href="../../da/ddf/structkey_mapping_table__st.html#a3489a10912c536ae8ee4b122b32b6915">posep</a>;       <span class="comment">// give special code back to be handled by the caller!</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">return</span> 0;       <span class="comment">// no kbd should be handled by the caller ...</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ainput_8h_html_a364833821774f6697a2f38dadd1af873"><div class="ttname"><a href="../../de/ded/input_8h.html#a364833821774f6697a2f38dadd1af873">JOY_SCAN_FIRE3</a></div><div class="ttdeci">#define JOY_SCAN_FIRE3</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00030">input.h:30</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html_a49468a16361d11e78ebbfc41f2a5aa6c"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html#a49468a16361d11e78ebbfc41f2a5aa6c">mouse_modes_st::wrap</a></div><div class="ttdeci">int wrap</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00077">input.c:77</a></div></div>
<div class="ttc" id="adave_8c_html_a69b2034307eede446ae2d54706852c35"><div class="ttname"><a href="../../da/d71/dave_8c.html#a69b2034307eede446ae2d54706852c35">kbd_selector</a></div><div class="ttdeci">int kbd_selector</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d71/dave_8c_source.html#l00035">dave.c:35</a></div></div>
<div class="ttc" id="ainput_8h_html_ab209282edfaeb97a7aebff2b8a2d95e3"><div class="ttname"><a href="../../de/ded/input_8h.html#ab209282edfaeb97a7aebff2b8a2d95e3">JOY_SCAN_LEFT</a></div><div class="ttdeci">#define JOY_SCAN_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00027">input.h:27</a></div></div>
<div class="ttc" id="ainput_8c_html_aa448c0cb91ad03a46cc92744df486142"><div class="ttname"><a href="../../d1/d06/input_8c.html#aa448c0cb91ad03a46cc92744df486142">BUTTON_EX3</a></div><div class="ttdeci">#define BUTTON_EX3</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00065">input.c:65</a></div></div>
<div class="ttc" id="ainput_8c_html_a8797e32ed46cecb131581bb44e4d3990"><div class="ttname"><a href="../../d1/d06/input_8c.html#a8797e32ed46cecb131581bb44e4d3990">mouse_reset_button</a></div><div class="ttdeci">void mouse_reset_button(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00163">input.c:163</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html_a0af704609df3a7bd1a6f3518eb743c75"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html#a0af704609df3a7bd1a6f3518eb743c75">mouse_modes_st::buttons</a></div><div class="ttdeci">int buttons[5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00075">input.c:75</a></div></div>
<div class="ttc" id="ainput_8c_html_abe9cce308f45bb08d664c5ef85140f83"><div class="ttname"><a href="../../d1/d06/input_8c.html#abe9cce308f45bb08d664c5ef85140f83">emu_mouse_wheel</a></div><div class="ttdeci">void emu_mouse_wheel(int x, int y, int flipped)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00268">input.c:268</a></div></div>
<div class="ttc" id="ainput_8c_html_a38a4d3ac176d8ff2c5d1c49245d5350e"><div class="ttname"><a href="../../d1/d06/input_8c.html#a38a4d3ac176d8ff2c5d1c49245d5350e">read_control_port_bits</a></div><div class="ttdeci">Uint8 read_control_port_bits(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00317">input.c:317</a></div></div>
<div class="ttc" id="ainput_8c_html_a829a12f841537fed33232bbbf7246d5e"><div class="ttname"><a href="../../d1/d06/input_8c.html#a829a12f841537fed33232bbbf7246d5e">emu_kbd</a></div><div class="ttdeci">int emu_kbd(SDL_Keysym sym, int press)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00420">input.c:420</a></div></div>
<div class="ttc" id="ainput_8h_html_a6acc06e48fc9c9fa27316147afcc6aaf"><div class="ttname"><a href="../../de/ded/input_8h.html#a6acc06e48fc9c9fa27316147afcc6aaf">JOY_SCAN_DOWN</a></div><div class="ttdeci">#define JOY_SCAN_DOWN</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00026">input.h:26</a></div></div>
<div class="ttc" id="ainput_8c_html_a2d60dfa7c3586ec04dc98e8e18daafcc"><div class="ttname"><a href="../../d1/d06/input_8c.html#a2d60dfa7c3586ec04dc98e8e18daafcc">mouse_mode</a></div><div class="ttdeci">int mouse_mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00133">input.c:133</a></div></div>
<div class="ttc" id="ascreen_8h_html"><div class="ttname"><a href="../../dd/ddc/screen_8h.html">screen.h</a></div></div>
<div class="ttc" id="ainput_8c_html_a9c6e59f8433c130974927919a9db4148"><div class="ttname"><a href="../../d1/d06/input_8c.html#a9c6e59f8433c130974927919a9db4148">emu_mouse_motion</a></div><div class="ttdeci">void emu_mouse_motion(int dx, int dy)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00251">input.c:251</a></div></div>
<div class="ttc" id="akeyboard__mapping_8h_html"><div class="ttname"><a href="../../d3/d94/keyboard__mapping_8h.html">keyboard_mapping.h</a></div></div>
<div class="ttc" id="ainput_8c_html_a467bc7e1df9449fe66eb94dfcfe47bf5"><div class="ttname"><a href="../../d1/d06/input_8c.html#a467bc7e1df9449fe66eb94dfcfe47bf5">JOYSTICK_SCAN</a></div><div class="ttdeci">#define JOYSTICK_SCAN(num, dir)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00135">input.c:135</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html#a8f8f80d37794cde9472343e4487ba3eb">mouse_modes_st::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00074">input.c:74</a></div></div>
<div class="ttc" id="astructkey_mapping_table__st_html"><div class="ttname"><a href="../../da/ddf/structkey_mapping_table__st.html">keyMappingTable_st</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d94/keyboard__mapping_8h_source.html#l00024">keyboard_mapping.h:24</a></div></div>
<div class="ttc" id="ainput_8c_html_a460806d5f5360a26d0b18b6cf3dca814"><div class="ttname"><a href="../../d1/d06/input_8c.html#a460806d5f5360a26d0b18b6cf3dca814">LAST_MOUSE_MODE</a></div><div class="ttdeci">#define LAST_MOUSE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00130">input.c:130</a></div></div>
<div class="ttc" id="ajoystick_8c_html_a7441ef0865bcb3db9b8064dd7375c1ea"><div class="ttname"><a href="../../d2/d84/joystick_8c.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d84/joystick_8c_source.html#l00052">joystick.c:52</a></div></div>
<div class="ttc" id="ainput_8c_html_abe573ffdd89c43a81a9ea5b8b38dad3c"><div class="ttname"><a href="../../d1/d06/input_8c.html#abe573ffdd89c43a81a9ea5b8b38dad3c">mouse_setup</a></div><div class="ttdeci">int mouse_setup(int cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00401">input.c:401</a></div></div>
<div class="ttc" id="afat32_8c_html_add440eff171ea5f55cb00c4a9ab8672d"><div class="ttname"><a href="../../d0/d3b/fat32_8c.html#add440eff171ea5f55cb00c4a9ab8672d">Uint32</a></div><div class="ttdeci">uint32_t Uint32</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/fat32_8c_source.html#l00049">fat32.c:49</a></div></div>
<div class="ttc" id="ainput_8c_html_aeee3440274a9907c9bceef55a0a37bd3"><div class="ttname"><a href="../../d1/d06/input_8c.html#aeee3440274a9907c9bceef55a0a37bd3">WATCHDOG_USEC</a></div><div class="ttdeci">#define WATCHDOG_USEC(n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00057">input.c:57</a></div></div>
<div class="ttc" id="ainput_8h_html_a1639273f22bb275b92990d3bcef8885c"><div class="ttname"><a href="../../de/ded/input_8h.html#a1639273f22bb275b92990d3bcef8885c">JOY_SCAN_FIRE1</a></div><div class="ttdeci">#define JOY_SCAN_FIRE1</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00024">input.h:24</a></div></div>
<div class="ttc" id="afat32_8c_html_a2944638813a090aa23e62f4da842c3e2"><div class="ttname"><a href="../../d0/d3b/fat32_8c.html#a2944638813a090aa23e62f4da842c3e2">Uint8</a></div><div class="ttdeci">uint8_t Uint8</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/fat32_8c_source.html#l00051">fat32.c:51</a></div></div>
<div class="ttc" id="ajoystick_8h_html"><div class="ttname"><a href="../../de/d5a/joystick_8h.html">joystick.h</a></div></div>
<div class="ttc" id="ascreen_8c_html_abfec8bad7720b38a264ea0d485a1f152"><div class="ttname"><a href="../../d5/d88/screen_8c.html#abfec8bad7720b38a264ea0d485a1f152">screen_grab</a></div><div class="ttdeci">void screen_grab(SDL_bool state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d88/screen_8c_source.html#l00156">screen.c:156</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html_a656d3a843ee9d0eb89e3e34c01b55aa6"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html#a656d3a843ee9d0eb89e3e34c01b55aa6">mouse_modes_st::nibbles</a></div><div class="ttdeci">int nibbles</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00076">input.c:76</a></div></div>
<div class="ttc" id="astructkey_mapping_table__st_html_a3489a10912c536ae8ee4b122b32b6915"><div class="ttname"><a href="../../da/ddf/structkey_mapping_table__st.html#a3489a10912c536ae8ee4b122b32b6915">keyMappingTable_st::posep</a></div><div class="ttdeci">Uint8 posep</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d94/keyboard__mapping_8h_source.html#l00026">keyboard_mapping.h:26</a></div></div>
<div class="ttc" id="ainput_8c_html_a63e32b51cb46f8186f153f2f2aba7ed2"><div class="ttname"><a href="../../d1/d06/input_8c.html#a63e32b51cb46f8186f153f2f2aba7ed2">show_keys</a></div><div class="ttdeci">int show_keys</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00041">input.c:41</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html">mouse_modes_st</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00073">input.c:73</a></div></div>
<div class="ttc" id="ainput_8c_html_a3fc69113544bb8325c3e9ea9c4c85321"><div class="ttname"><a href="../../d1/d06/input_8c.html#a3fc69113544bb8325c3e9ea9c4c85321">K_COLUMN</a></div><div class="ttdeci">#define K_COLUMN</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00071">input.c:71</a></div></div>
<div class="ttc" id="adave_8c_html_aba4a26be2633bba89bf26c9a92819563"><div class="ttname"><a href="../../da/d71/dave_8c.html#aba4a26be2633bba89bf26c9a92819563">kbd_matrix</a></div><div class="ttdeci">Uint8 kbd_matrix[16]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d71/dave_8c_source.html#l00030">dave.c:30</a></div></div>
<div class="ttc" id="ainput_8c_html_a9aa29cbc03517be05303ef2d01f9479a"><div class="ttname"><a href="../../d1/d06/input_8c.html#a9aa29cbc03517be05303ef2d01f9479a">emu_mouse_button</a></div><div class="ttdeci">void emu_mouse_button(Uint8 sdl_button, int press)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00182">input.c:182</a></div></div>
<div class="ttc" id="avera_8c_html_a1ea5d0cb93f22f7d0fdf804bd68c3326"><div class="ttname"><a href="../../d8/dda/vera_8c.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dda/vera_8c_source.html#l00061">vera.c:61</a></div></div>
<div class="ttc" id="ainput_8h_html_a6b61a96d64da933d85da475a2e3fb08f"><div class="ttname"><a href="../../de/ded/input_8h.html#a6b61a96d64da933d85da475a2e3fb08f">JOY_SCAN_RIGHT</a></div><div class="ttdeci">#define JOY_SCAN_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00028">input.h:28</a></div></div>
<div class="ttc" id="afat32_8c_html_a4fc34b120ed3bd1120c1eb36abbcd6af"><div class="ttname"><a href="../../d0/d3b/fat32_8c.html#a4fc34b120ed3bd1120c1eb36abbcd6af">NL</a></div><div class="ttdeci">#define NL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/fat32_8c_source.html#l00037">fat32.c:37</a></div></div>
<div class="ttc" id="ainput_8c_html_a597dc300d5919a96a20db9aafe9f233b"><div class="ttname"><a href="../../d1/d06/input_8c.html#a597dc300d5919a96a20db9aafe9f233b">J_COLUMN</a></div><div class="ttdeci">#define J_COLUMN</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00070">input.c:70</a></div></div>
<div class="ttc" id="ainput_8c_html_aac666c4151f89b34f876ae60e9cdbae7"><div class="ttname"><a href="../../d1/d06/input_8c.html#aac666c4151f89b34f876ae60e9cdbae7">BUTTON_OTHER</a></div><div class="ttdeci">#define BUTTON_OTHER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00064">input.c:64</a></div></div>
<div class="ttc" id="ainput_8c_html_acc19689fdf649d072d7147f45a845a70"><div class="ttname"><a href="../../d1/d06/input_8c.html#acc19689fdf649d072d7147f45a845a70">BUTTON_EX5</a></div><div class="ttdeci">#define BUTTON_EX5</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00067">input.c:67</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html_a5ad72a5b78977b3b3db3212287e09806"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html#a5ad72a5b78977b3b3db3212287e09806">mouse_modes_st::data_mask</a></div><div class="ttdeci">int data_mask</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00079">input.c:79</a></div></div>
<div class="ttc" id="af018__core_8c_html_ab77cc972f3ee899689ba053015472ccd"><div class="ttname"><a href="../../da/d70/f018__core_8c.html#ab77cc972f3ee899689ba053015472ccd">mask</a></div><div class="ttdeci">int mask</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d70/f018__core_8c_source.html#l00121">f018_core.c:121</a></div></div>
<div class="ttc" id="adave_8h_html"><div class="ttname"><a href="../../d1/d13/dave_8h.html">dave.h</a></div></div>
<div class="ttc" id="arecpm_2console_8c_html_a0a2f84ed7838f07779ae24c5a9086d33"><div class="ttname"><a href="../../d8/d51/recpm_2console_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d51/recpm_2console_8c_source.html#l00027">console.c:27</a></div></div>
<div class="ttc" id="axep128_8h_html"><div class="ttname"><a href="../../d1/df4/xep128_8h.html">xep128.h</a></div></div>
<div class="ttc" id="ainput_8c_html_a17f09b1b0019a960c7d9f6f79ca65345"><div class="ttname"><a href="../../d1/d06/input_8c.html#a17f09b1b0019a960c7d9f6f79ca65345">mouse_reset</a></div><div class="ttdeci">void mouse_reset(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00286">input.c:286</a></div></div>
<div class="ttc" id="axep128_8h_html_a7b07ef73975a2766765a64425ae4ee43"><div class="ttname"><a href="../../d1/df4/xep128_8h.html#a7b07ef73975a2766765a64425ae4ee43">OSD</a></div><div class="ttdeci">#define OSD(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df4/xep128_8h_source.html#l00100">xep128.h:100</a></div></div>
<div class="ttc" id="ainput_8c_html_ad11af82c9993545badf6af4cbf8e9faa"><div class="ttname"><a href="../../d1/d06/input_8c.html#ad11af82c9993545badf6af4cbf8e9faa">mouse_mode_description</a></div><div class="ttdeci">int mouse_mode_description(int cfg, char *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00139">input.c:139</a></div></div>
<div class="ttc" id="astructmouse__modes__st_html_a03a2c1c7a4c376bfcd7e6ba15bcfafb6"><div class="ttname"><a href="../../d9/d45/structmouse__modes__st.html#a03a2c1c7a4c376bfcd7e6ba15bcfafb6">mouse_modes_st::watchdog</a></div><div class="ttdeci">int watchdog</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00078">input.c:78</a></div></div>
<div class="ttc" id="ainput_8h_html_a0f02d0142cc5bbb169c601846df6bf5c"><div class="ttname"><a href="../../de/ded/input_8h.html#a0f02d0142cc5bbb169c601846df6bf5c">JOY_SCAN_UP</a></div><div class="ttdeci">#define JOY_SCAN_UP</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00025">input.h:25</a></div></div>
<div class="ttc" id="akeyboard__mapping_8c_html_a15b42a96c012e30262c24c91dce2e2c9"><div class="ttname"><a href="../../d9/d6e/keyboard__mapping_8c.html#a15b42a96c012e30262c24c91dce2e2c9">keymap_resolve_event</a></div><div class="ttdeci">const struct keyMappingTable_st * keymap_resolve_event(SDL_Keysym sym)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6e/keyboard__mapping_8c_source.html#l00207">keyboard_mapping.c:207</a></div></div>
<div class="ttc" id="ajoystick_8c_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d2/d84/joystick_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d84/joystick_8c_source.html#l00046">joystick.c:46</a></div></div>
<div class="ttc" id="ainput_8c_html_aaa9ee6717f5b7774453aaf22e8b0e0a9"><div class="ttname"><a href="../../d1/d06/input_8c.html#aaa9ee6717f5b7774453aaf22e8b0e0a9">raster_time</a></div><div class="ttdeci">Uint32 raster_time</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d40/nick_8c_source.html#l00058">nick.c:58</a></div></div>
<div class="ttc" id="ainput_8c_html_ab2fcfcf1f1a24ac641b3803f9bbad631"><div class="ttname"><a href="../../d1/d06/input_8c.html#ab2fcfcf1f1a24ac641b3803f9bbad631">BUTTON_EX4</a></div><div class="ttdeci">#define BUTTON_EX4</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00066">input.c:66</a></div></div>
<div class="ttc" id="ainput_8c_html_ad0ac6df3892f25f13403f077ff4ecaaa"><div class="ttname"><a href="../../d1/d06/input_8c.html#ad0ac6df3892f25f13403f077ff4ecaaa">mouse_grab</a></div><div class="ttdeci">int mouse_grab</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00030">input.c:30</a></div></div>
<div class="ttc" id="aemutools__basicdefs_8h_html_a96dd473db0b3d10bd43390cdacb00120"><div class="ttname"><a href="../../d9/d99/emutools__basicdefs_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a></div><div class="ttdeci">#define DEBUG(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d99/emutools__basicdefs_8h_source.html#l00152">emutools_basicdefs.h:152</a></div></div>
<div class="ttc" id="ainput_8c_html_af82fa4e8a84126c46a67531977c694f7"><div class="ttname"><a href="../../d1/d06/input_8c.html#af82fa4e8a84126c46a67531977c694f7">mouse_check_data_shift</a></div><div class="ttdeci">void mouse_check_data_shift(Uint8 val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00364">input.c:364</a></div></div>
<div class="ttc" id="arecpm_2console_8c_html_a6150e0515f7202e2fb518f7206ed97dc"><div class="ttname"><a href="../../d8/d51/recpm_2console_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d51/recpm_2console_8c_source.html#l00027">console.c:27</a></div></div>
<div class="ttc" id="ainput_8h_html"><div class="ttname"><a href="../../de/ded/input_8h.html">input.h</a></div></div>
<div class="ttc" id="ainput_8c_html_a456272844afce00fe802b53e8b456c6f"><div class="ttname"><a href="../../d1/d06/input_8c.html#a456272844afce00fe802b53e8b456c6f">BUTTON_MAIN</a></div><div class="ttdeci">#define BUTTON_MAIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d06/input_8c_source.html#l00063">input.c:63</a></div></div>
<div class="ttc" id="ainput_8h_html_afefc4719a71e8e74a776d1d3770a20c1"><div class="ttname"><a href="../../de/ded/input_8h.html#afefc4719a71e8e74a776d1d3770a20c1">JOY_SCAN_FIRE2</a></div><div class="ttdeci">#define JOY_SCAN_FIRE2</div><div class="ttdef"><b>Definition:</b> <a href="../../de/ded/input_8h_source.html#l00029">input.h:29</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
